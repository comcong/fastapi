<!DOCTYPE html>
<html lang="ko">
<head>
  <style>
/* 테이블 전체 스타일 */
#data-table {
    border-collapse: collapse; /* 테두리 겹치지 않게 */
    width: 80%;
    margin: 20px 0;
    font-family: Arial, sans-serif;
    text-align: center;
}

/* 헤더 스타일 */
#data-table thead th {
    background-color: #4CAF50;
    color: white;
    padding: 8px;
}

/* tbody 셀 스타일 */
#data-table tbody td {
    padding: 8px;
    border: 1px solid #ddd;
}

/* 홀수/짝수 줄 색상 */
#data-table tbody tr:nth-child(odd) {
    background-color: #f2f2f2;
}

#data-table tbody tr:nth-child(even) {
    background-color: #ffffff;
}

/* 마우스 오버 시 강조 */
#data-table tbody tr:hover {
    background-color: #ddd;
}
</style>


<meta charset="UTF-8">
<title>htmx WebSocket DataFrame 표시</title>
<script src="https://unpkg.com/htmx.org@1.9.10"></script>
<script src="https://unpkg.com/htmx.org/dist/ext/ws.js"></script>
</head>
<body>
<h1>실시간 DataFrame 테이블</h1>

<!-- htmx WebSocket 연결 -->
<div hx-ext="ws" ws-connect="ws"></div>

<table id="data-table">
    <thead id="table-head">
    <!-- 고정 컬럼 -->
    <tr>    <th>A</th><th>B</th><th>C</th><th>수익률</th>    </tr>
    </thead>

  <tbody id="table-body">
        <tr>  <td></td><td></td><td></td><td></td>  </tr>
  </tbody>
</table>


<script>
  const ws = new WebSocket("ws://localhost:8000/ws");

  ws.onmessage = (event) => {
    document.getElementById("table-body").outerHTML = event.data;

    // 수익률 컬럼 색상 적용 (마지막 열)
    document.querySelectorAll("#table-body tr").forEach(tr => {
      const td = tr.lastElementChild; // 수익률 컬럼
      const value = parseFloat(td.textContent);
      if (value > 0) td.style.color = "red";
      else if (value < 0) td.style.color = "blue";
      else td.style.color = "black"; // 0인 경우
    });
  };
</script>


</body>
</html>
